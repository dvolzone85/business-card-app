<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:m="http://schemas.microsoft.com/office/2004/12/omml"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 15">
<meta name=Originator content="Microsoft Word 15">
<link rel=File-List href="business-card-scanner_file/filelist.xml">
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Danilo Volzone</o:Author>
  <o:LastAuthor>Danilo Volzone</o:LastAuthor>
  <o:Revision>1</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2025-09-09T08:39:00Z</o:Created>
  <o:LastSaved>2025-09-09T08:40:00Z</o:LastSaved>
  <o:Pages>40</o:Pages>
  <o:Words>6246</o:Words>
  <o:Characters>35608</o:Characters>
  <o:Lines>296</o:Lines>
  <o:Paragraphs>83</o:Paragraphs>
  <o:CharactersWithSpaces>41771</o:CharactersWithSpaces>
  <o:Version>16.00</o:Version>
 </o:DocumentProperties>
 <o:OfficeDocumentSettings>
  <o:AllowPNG/>
 </o:OfficeDocumentSettings>
</xml><![endif]-->
<link rel=themeData href="business-card-scanner_file/themedata.thmx">
<link rel=colorSchemeMapping
href="business-card-scanner_file/colorschememapping.xml">
<!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:TrackMoves>false</w:TrackMoves>
  <w:TrackFormatting/>
  <w:HyphenationZone>14</w:HyphenationZone>
  <w:PunctuationKerning/>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:DoNotPromoteQF/>
  <w:LidThemeOther>IT</w:LidThemeOther>
  <w:LidThemeAsian>X-NONE</w:LidThemeAsian>
  <w:LidThemeComplexScript>X-NONE</w:LidThemeComplexScript>
  <w:Compatibility>
   <w:BreakWrappedTables/>
   <w:SnapToGridInCell/>
   <w:WrapTextWithPunct/>
   <w:UseAsianBreakRules/>
   <w:DontGrowAutofit/>
   <w:SplitPgBreakAndParaMark/>
   <w:EnableOpenTypeKerning/>
   <w:DontFlipMirrorIndents/>
   <w:OverrideTableStyleHps/>
  </w:Compatibility>
  <m:mathPr>
   <m:mathFont m:val="Cambria Math"/>
   <m:brkBin m:val="before"/>
   <m:brkBinSub m:val="&#45;-"/>
   <m:smallFrac m:val="off"/>
   <m:dispDef/>
   <m:lMargin m:val="0"/>
   <m:rMargin m:val="0"/>
   <m:defJc m:val="centerGroup"/>
   <m:wrapIndent m:val="1440"/>
   <m:intLim m:val="subSup"/>
   <m:naryLim m:val="undOvr"/>
  </m:mathPr></w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" DefUnhideWhenUsed="false"
  DefSemiHidden="false" DefQFormat="false" DefPriority="99"
  LatentStyleCount="376">
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="Normal"/>
  <w:LsdException Locked="false" Priority="0" QFormat="true" Name="heading 1"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 2"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 3"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 4"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 5"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 6"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 7"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 8"/>
  <w:LsdException Locked="false" Priority="9" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="heading 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index 9"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 1"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 2"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 3"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 4"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 5"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 6"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 7"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 8"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" Name="toc 9"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="header"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footer"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="index heading"/>
  <w:LsdException Locked="false" Priority="35" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="caption"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of figures"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="envelope return"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="footnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="line number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="page number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote reference"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="endnote text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="table of authorities"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="macro"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="toa heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Bullet 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Number 5"/>
  <w:LsdException Locked="false" Priority="10" QFormat="true" Name="Title"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Closing"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Signature"/>
  <w:LsdException Locked="false" Priority="1" SemiHidden="true"
   UnhideWhenUsed="true" Name="Default Paragraph Font"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="List Continue 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Message Header"/>
  <w:LsdException Locked="false" Priority="11" QFormat="true" Name="Subtitle"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Salutation"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Date"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text First Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Note Heading"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Body Text Indent 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Block Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="FollowedHyperlink"/>
  <w:LsdException Locked="false" Priority="22" QFormat="true" Name="Strong"/>
  <w:LsdException Locked="false" Priority="20" QFormat="true" Name="Emphasis"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Document Map"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Plain Text"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="E-mail Signature"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Top of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Bottom of Form"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal (Web)"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Acronym"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Address"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Cite"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Code"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Definition"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Keyboard"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Preformatted"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Sample"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Typewriter"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="HTML Variable"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Normal Table"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="annotation subject"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="No List"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Outline List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Simple 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Classic 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Colorful 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Columns 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Grid 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 4"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 5"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 7"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table List 8"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table 3D effects 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Contemporary"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Elegant"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Professional"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Subtle 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 1"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 2"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Web 3"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Balloon Text"/>
  <w:LsdException Locked="false" Priority="39" Name="Table Grid"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Table Theme"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Placeholder Text"/>
  <w:LsdException Locked="false" Priority="1" QFormat="true" Name="No Spacing"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 1"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 1"/>
  <w:LsdException Locked="false" SemiHidden="true" Name="Revision"/>
  <w:LsdException Locked="false" Priority="34" QFormat="true"
   Name="List Paragraph"/>
  <w:LsdException Locked="false" Priority="29" QFormat="true" Name="Quote"/>
  <w:LsdException Locked="false" Priority="30" QFormat="true"
   Name="Intense Quote"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 1"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 1"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 1"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 1"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 1"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 2"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 2"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 2"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 2"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 2"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 2"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 3"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 3"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 3"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 3"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 3"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 3"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 4"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 4"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 4"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 4"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 4"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 4"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 5"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 5"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 5"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 5"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 5"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 5"/>
  <w:LsdException Locked="false" Priority="60" Name="Light Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="61" Name="Light List Accent 6"/>
  <w:LsdException Locked="false" Priority="62" Name="Light Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="63" Name="Medium Shading 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="64" Name="Medium Shading 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="65" Name="Medium List 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="66" Name="Medium List 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="67" Name="Medium Grid 1 Accent 6"/>
  <w:LsdException Locked="false" Priority="68" Name="Medium Grid 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="69" Name="Medium Grid 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="70" Name="Dark List Accent 6"/>
  <w:LsdException Locked="false" Priority="71" Name="Colorful Shading Accent 6"/>
  <w:LsdException Locked="false" Priority="72" Name="Colorful List Accent 6"/>
  <w:LsdException Locked="false" Priority="73" Name="Colorful Grid Accent 6"/>
  <w:LsdException Locked="false" Priority="19" QFormat="true"
   Name="Subtle Emphasis"/>
  <w:LsdException Locked="false" Priority="21" QFormat="true"
   Name="Intense Emphasis"/>
  <w:LsdException Locked="false" Priority="31" QFormat="true"
   Name="Subtle Reference"/>
  <w:LsdException Locked="false" Priority="32" QFormat="true"
   Name="Intense Reference"/>
  <w:LsdException Locked="false" Priority="33" QFormat="true" Name="Book Title"/>
  <w:LsdException Locked="false" Priority="37" SemiHidden="true"
   UnhideWhenUsed="true" Name="Bibliography"/>
  <w:LsdException Locked="false" Priority="39" SemiHidden="true"
   UnhideWhenUsed="true" QFormat="true" Name="TOC Heading"/>
  <w:LsdException Locked="false" Priority="41" Name="Plain Table 1"/>
  <w:LsdException Locked="false" Priority="42" Name="Plain Table 2"/>
  <w:LsdException Locked="false" Priority="43" Name="Plain Table 3"/>
  <w:LsdException Locked="false" Priority="44" Name="Plain Table 4"/>
  <w:LsdException Locked="false" Priority="45" Name="Plain Table 5"/>
  <w:LsdException Locked="false" Priority="40" Name="Grid Table Light"/>
  <w:LsdException Locked="false" Priority="46" Name="Grid Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="Grid Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="Grid Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="Grid Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="Grid Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="Grid Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="Grid Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="Grid Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="Grid Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="Grid Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="46" Name="List Table 1 Light"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark"/>
  <w:LsdException Locked="false" Priority="51" Name="List Table 6 Colorful"/>
  <w:LsdException Locked="false" Priority="52" Name="List Table 7 Colorful"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 1"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 1"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 1"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 1"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 1"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 1"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 2"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 2"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 2"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 2"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 2"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 2"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 3"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 3"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 3"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 3"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 3"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 3"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 4"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 4"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 4"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 4"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 4"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 4"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 5"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 5"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 5"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 5"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 5"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 5"/>
  <w:LsdException Locked="false" Priority="46"
   Name="List Table 1 Light Accent 6"/>
  <w:LsdException Locked="false" Priority="47" Name="List Table 2 Accent 6"/>
  <w:LsdException Locked="false" Priority="48" Name="List Table 3 Accent 6"/>
  <w:LsdException Locked="false" Priority="49" Name="List Table 4 Accent 6"/>
  <w:LsdException Locked="false" Priority="50" Name="List Table 5 Dark Accent 6"/>
  <w:LsdException Locked="false" Priority="51"
   Name="List Table 6 Colorful Accent 6"/>
  <w:LsdException Locked="false" Priority="52"
   Name="List Table 7 Colorful Accent 6"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Hyperlink"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Hashtag"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Unresolved Mention"/>
  <w:LsdException Locked="false" SemiHidden="true" UnhideWhenUsed="true"
   Name="Smart Link"/>
 </w:LatentStyles>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:roman;
	mso-font-pitch:variable;
	mso-font-signature:-536869121 1107305727 33554432 0 415 0;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-469750017 -1073732485 9 0 511 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-parent:"";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
h1
	{mso-style-update:auto;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 1 Carattere";
	mso-style-next:Normale;
	margin:0cm;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Arial",sans-serif;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;
	font-weight:normal;
	font-style:italic;
	mso-bidi-font-style:normal;}
h2
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 2 Carattere";
	mso-style-next:Normale;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h3
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 3 Carattere";
	mso-style-next:Normale;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h4
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 4 Carattere";
	mso-style-next:Normale;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-weight:normal;
	font-style:italic;}
h5
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 5 Carattere";
	mso-style-next:Normale;
	margin-top:4.0pt;
	margin-right:0cm;
	margin-bottom:2.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:5;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-weight:normal;}
h6
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 6 Carattere";
	mso-style-next:Normale;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:6;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-weight:normal;
	font-style:italic;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 7 Carattere";
	mso-style-next:Normale;
	margin-top:2.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:7;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 8 Carattere";
	mso-style-next:Normale;
	margin:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:8;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-qformat:yes;
	mso-style-link:"Titolo 9 Carattere";
	mso-style-next:Normale;
	margin:0cm;
	line-height:107%;
	mso-pagination:widow-orphan lines-together;
	page-break-after:avoid;
	mso-outline-level:9;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Titolo Carattere";
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Titolo Carattere";
	mso-style-next:Normale;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Titolo Carattere";
	mso-style-next:Normale;
	mso-style-type:export-only;
	margin:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Titolo Carattere";
	mso-style-next:Normale;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:4.0pt;
	margin-left:0cm;
	mso-add-space:auto;
	mso-pagination:widow-orphan;
	font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Sottotitolo Carattere";
	mso-style-next:Normale;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:14.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{mso-style-priority:34;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-type:export-only;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:36.0pt;
	mso-add-space:auto;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;}
p.MsoQuote, li.MsoQuote, div.MsoQuote
	{mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Citazione Carattere";
	mso-style-next:Normale;
	margin-top:8.0pt;
	margin-right:0cm;
	margin-bottom:8.0pt;
	margin-left:0cm;
	text-align:center;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-style:italic;}
p.MsoIntenseQuote, li.MsoIntenseQuote, div.MsoIntenseQuote
	{mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	mso-style-link:"Citazione intensa Carattere";
	mso-style-next:Normale;
	margin-top:18.0pt;
	margin-right:43.2pt;
	margin-bottom:18.0pt;
	margin-left:43.2pt;
	text-align:center;
	line-height:107%;
	mso-pagination:widow-orphan;
	border:none;
	mso-border-top-alt:solid #2F5496 .5pt;
	mso-border-top-themecolor:accent1;
	mso-border-top-themeshade:191;
	mso-border-bottom-alt:solid #2F5496 .5pt;
	mso-border-bottom-themecolor:accent1;
	mso-border-bottom-themeshade:191;
	padding:0cm;
	mso-padding-alt:10.0pt 0cm 10.0pt 0cm;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-ansi-language:#580A;
	mso-fareast-language:EN-US;
	font-style:italic;}
span.MsoIntenseEmphasis
	{mso-style-priority:21;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	font-style:italic;}
span.MsoIntenseReference
	{mso-style-priority:32;
	mso-style-unhide:no;
	mso-style-qformat:yes;
	font-variant:small-caps;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	letter-spacing:.25pt;
	font-weight:bold;}
span.Titolo1Carattere
	{mso-style-name:"Titolo 1 Carattere";
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-parent:"";
	mso-style-link:"Titolo 1";
	mso-ansi-font-size:12.0pt;
	font-family:"Arial",sans-serif;
	mso-ascii-font-family:Arial;
	mso-hansi-font-family:Arial;
	font-style:italic;
	mso-bidi-font-style:normal;}
span.Titolo2Carattere
	{mso-style-name:"Titolo 2 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 2";
	mso-ansi-font-size:16.0pt;
	mso-bidi-font-size:16.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-ansi-language:#580A;}
span.Titolo3Carattere
	{mso-style-name:"Titolo 3 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 3";
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-ansi-language:#580A;}
span.Titolo4Carattere
	{mso-style-name:"Titolo 4 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 4";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-ansi-language:#580A;
	font-style:italic;}
span.Titolo5Carattere
	{mso-style-name:"Titolo 5 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 5";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-ansi-language:#580A;}
span.Titolo6Carattere
	{mso-style-name:"Titolo 6 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 6";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-ansi-language:#580A;
	font-style:italic;}
span.Titolo7Carattere
	{mso-style-name:"Titolo 7 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 7";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	mso-ansi-language:#580A;}
span.Titolo8Carattere
	{mso-style-name:"Titolo 8 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 8";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-ansi-language:#580A;
	font-style:italic;}
span.Titolo9Carattere
	{mso-style-name:"Titolo 9 Carattere";
	mso-style-noshow:yes;
	mso-style-priority:9;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Titolo 9";
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#272727;
	mso-themecolor:text1;
	mso-themetint:216;
	mso-ansi-language:#580A;}
span.TitoloCarattere
	{mso-style-name:"Titolo Carattere";
	mso-style-priority:10;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Titolo;
	mso-ansi-font-size:28.0pt;
	mso-bidi-font-size:28.0pt;
	font-family:"Calibri Light",sans-serif;
	mso-ascii-font-family:"Calibri Light";
	mso-ascii-theme-font:major-latin;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-hansi-font-family:"Calibri Light";
	mso-hansi-theme-font:major-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	letter-spacing:-.5pt;
	mso-font-kerning:14.0pt;
	mso-ansi-language:#580A;}
span.SottotitoloCarattere
	{mso-style-name:"Sottotitolo Carattere";
	mso-style-priority:11;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Sottotitolo;
	mso-ansi-font-size:14.0pt;
	mso-bidi-font-size:14.0pt;
	font-family:"Times New Roman",serif;
	mso-fareast-font-family:"Times New Roman";
	mso-fareast-theme-font:major-fareast;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:major-bidi;
	color:#595959;
	mso-themecolor:text1;
	mso-themetint:166;
	letter-spacing:.75pt;
	mso-ansi-language:#580A;}
span.CitazioneCarattere
	{mso-style-name:"Citazione Carattere";
	mso-style-priority:29;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:Citazione;
	color:#404040;
	mso-themecolor:text1;
	mso-themetint:191;
	mso-ansi-language:#580A;
	font-style:italic;}
span.CitazioneintensaCarattere
	{mso-style-name:"Citazione intensa Carattere";
	mso-style-priority:30;
	mso-style-unhide:no;
	mso-style-locked:yes;
	mso-style-link:"Citazione intensa";
	color:#2F5496;
	mso-themecolor:accent1;
	mso-themeshade:191;
	mso-ansi-language:#580A;
	font-style:italic;}
.MsoChpDefault
	{mso-style-type:export-only;
	mso-default-props:yes;
	font-size:11.0pt;
	mso-ansi-font-size:11.0pt;
	mso-bidi-font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-fareast-font-family:Calibri;
	mso-fareast-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-fareast-language:EN-US;}
.MsoPapDefault
	{mso-style-type:export-only;
	margin-bottom:8.0pt;
	line-height:107%;}
@page WordSection1
	{size:595.3pt 841.9pt;
	margin:70.85pt 2.0cm 2.0cm 2.0cm;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.WordSection1
	{page:WordSection1;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:"Tabella normale";
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-priority:99;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin-top:0cm;
	mso-para-margin-right:0cm;
	mso-para-margin-bottom:8.0pt;
	mso-para-margin-left:0cm;
	line-height:107%;
	mso-pagination:widow-orphan;
	font-size:11.0pt;
	font-family:"Calibri",sans-serif;
	mso-ascii-font-family:Calibri;
	mso-ascii-theme-font:minor-latin;
	mso-hansi-font-family:Calibri;
	mso-hansi-theme-font:minor-latin;
	mso-bidi-font-family:"Times New Roman";
	mso-bidi-theme-font:minor-bidi;
	mso-font-kerning:1.0pt;
	mso-ligatures:standardcontextual;
	mso-fareast-language:EN-US;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1026"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=IT style='tab-interval:35.4pt;word-wrap:break-word'>

<div class=WordSection1>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>// INTEGRAZIONI SERVIZI ESTERNI E
FUNZIONALIT AVANZATE<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 1. OCR REALE CON GOOGLE VISION API<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class GoogleVisionOCR {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor(apiKey) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.apiKey = apiKey;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.apiUrl = 'https://vision.googleapis.com/v1/images:annotate';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async extractTextFromImage(imageBase64) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const requestBody = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>requests: [{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>image: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>content:
imageBase64.replace(/^data:image\/(png|jpg|jpeg);base64,/, '')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>features: [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>{ type: 'TEXT_DETECTION',
maxResults: 1 },<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>{ type:
'DOCUMENT_TEXT_DETECTION', maxResults: 1 }<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await fetch(`${this.apiUrl}?key=${this.apiKey}`, {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>method: 'POST',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>headers: { 'Content-Type':
'application/json' },<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>body:
JSON.stringify(requestBody)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const result = await response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return this.parseBusinessCardData(result.responses[0]);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('OCR Error:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>throw error;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>parseBusinessCardData(ocrResponse) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const text = ocrResponse.fullTextAnnotation?.text || '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Pattern matching per estrarre informazioni<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const patterns = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>email: /[\w\.-]+@[\w\.-]+\.\w+/g,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>phone:
/[\+]?[(]?[0-9]{1,4}[)]?[-\s\.]?[(]?[0-9]{1,4}[)]?[-\s\.]?[0-9]{1,5}[-\s\.]?[0-9]{1,5}/g,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>website:
/(?:www\.)?[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|https?:\/\/[^\s]+/g,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>linkedin: /linkedin\.com\/in\/[\w-]+/gi,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>vat: /(?:P\.?IVA|VAT)\s*:?\s*([A-Z0-9]+)/gi<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const lines = text.split('\n').filter(line =&gt; line.trim());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>fullText: text,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>name: this.extractName(lines),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>company: this.extractCompany(lines),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>role: this.extractRole(lines),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>email: (text.match(patterns.email) || [])[0],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>phone: this.formatPhone((text.match(patterns.phone) || [])[0]),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>website: (text.match(patterns.website) || [])[0],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>linkedin: (text.match(patterns.linkedin) || [])[0],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>vat: this.extractVAT(text),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>address: this.extractAddress(lines)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>extractName(lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Il nome  spesso nelle prime righe e in caratteri pi grandi<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const namePatterns = [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>/^([A-Z][a-z]+\s+[A-Z][a-z]+(?:\s+[A-Z][a-z]+)?)$/,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>/^(Dott\.?|Dr\.?|Ing\.?|Avv\.?)?\s*([A-Z][a-z]+\s+[A-Z][a-z]+)$/<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let i = 0; i &lt; Math.min(3, lines.length); i++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let pattern of namePatterns) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>const match =
lines[i].match(pattern);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>if (match) return
match[0].trim();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return lines[0]; // Fallback alla prima riga<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>extractCompany(lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const companyKeywords = ['S.r.l.', 'S.p.A.', 'Inc.', 'Ltd.', 'GmbH',
'LLC', 'Corporation', 'Company'];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let line of lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (companyKeywords.some(keyword =&gt; line.includes(keyword))) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return line.trim();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Cerca la riga dopo il nome<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return lines[1] || '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>extractRole(lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const roleKeywords = ['CEO', 'Manager', 'Director', 'Presidente',
'Amministratore', <o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Responsabile',
'Consulente', 'Sales', 'Marketing', 'Developer'];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let line of lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (roleKeywords.some(keyword =&gt;
line.toLowerCase().includes(keyword.toLowerCase()))) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return line.trim();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>extractAddress(lines) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const addressPatterns = [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>/via|viale|corso|piazza|largo|strada/i,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>/\d{5}/, // CAP italiano<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>/\d+,?\s*\d{5}/ // Numero civico + CAP<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let i = 0; i &lt; lines.length; i++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (addressPatterns.some(pattern =&gt; pattern.test(lines[i]))) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>// Prendi questa riga e la
successiva<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return lines.slice(i,
Math.min(i + 2, lines.length)).join(', ');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>formatPhone(phone) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!phone) return '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Formatta numero italiano<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return phone.replace(/\s+/g, ' ').trim();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>extractVAT(text) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const vatMatch = text.match(/(?:P\.?IVA|VAT)\s*:?\s*([A-Z0-9]+)/i);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return vatMatch ? vatMatch[1] : '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 2. INTEGRAZIONE CRM (HubSpot,
Salesforce, Pipedrive)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class CRMIntegration {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor(crmType, apiKey) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.crmType = crmType;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.apiKey = apiKey;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.endpoints = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>hubspot: 'https://api.hubapi.com/crm/v3/objects/contacts',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>salesforce:
'https://your-instance.salesforce.com/services/data/v55.0/sobjects/Contact',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>pipedrive: 'https://api.pipedrive.com/v1/persons'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async syncContact(contactData) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>switch(this.crmType) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>case 'hubspot':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return
this.syncToHubSpot(contactData);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>case 'salesforce':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return
this.syncToSalesforce(contactData);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>case 'pipedrive':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return
this.syncToPipedrive(contactData);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>default:<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>throw new Error('CRM non
supportato');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async syncToHubSpot(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const hubspotData = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>properties: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>firstname: contact.name.split('
')[0],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>lastname: contact.name.split('
').slice(1).join(' '),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>email: contact.email,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>phone: contact.phone,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>company: contact.company,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>jobtitle: contact.role,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>address: contact.address,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>hs_lead_status: 'NEW'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await fetch(this.endpoints.hubspot, {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>method: 'POST',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headers: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Authorization': `Bearer
${this.apiKey}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Content-Type':
'application/json'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>body: JSON.stringify(hubspotData)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async syncToSalesforce(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Richiede OAuth2 authentication<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const salesforceData = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>FirstName: contact.name.split(' ')[0],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>LastName: contact.name.split(' ').slice(1).join(' '),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>Email: contact.email,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>Phone: contact.phone,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>Title: contact.role,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>Company: contact.company,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>MailingStreet: contact.address,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>LeadSource: 'Business Card'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await fetch(this.endpoints.salesforce, {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>method: 'POST',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headers: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Authorization': `Bearer
${this.apiKey}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Content-Type':
'application/json'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>body: JSON.stringify(salesforceData)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async syncToPipedrive(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const pipedriveData = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>name: contact.name,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>email: contact.email,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>phone: contact.phone,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>org_name: contact.company,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>job_title: contact.role,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>visible_to: '3' // Everyone<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await
fetch(`${this.endpoints.pipedrive}?api_token=${this.apiKey}`, {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>method: 'POST',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headers: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Content-Type':
'application/json'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>body: JSON.stringify(pipedriveData)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async bulkSync(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const results = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (const contact of contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>const result = await
this.syncContact(contact);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>results.push({ success: true,
contact, result });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>results.push({ success: false,
contact, error: error.message });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return results;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 3. SINCRONIZZAZIONE CLOUD (Firebase)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class CloudSync {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor(firebaseConfig) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Inizializza Firebase<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.firebaseConfig = firebaseConfig;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// firebase.initializeApp(firebaseConfig);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// this.db = firebase.firestore();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// this.auth = firebase.auth();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// this.storage = firebase.storage();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async initializeFirebase() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const firebaseConfig = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>apiKey: &quot;your-api-key&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>authDomain: &quot;your-app.firebaseapp.com&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>projectId: &quot;your-project-id&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>storageBucket: &quot;your-app.appspot.com&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>messagingSenderId: &quot;sender-id&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>appId: &quot;app-id&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Script da includere nell'HTML<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// &lt;script
src=&quot;https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// &lt;script
src=&quot;https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// &lt;script
src=&quot;https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// &lt;script
src=&quot;https://www.gstatic.com/firebasejs/9.0.0/firebase-storage-compat.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async authenticateUser(email, password) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const userCredential = await
firebase.auth().signInWithEmailAndPassword(email, password);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return userCredential.user;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('Authentication error:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>throw error;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async saveContact(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const docRef = await firebase.firestore().collection('contacts').add({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>...contact,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>userId:
firebase.auth().currentUser.uid,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>createdAt:
firebase.firestore.FieldValue.serverTimestamp(),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>updatedAt:
firebase.firestore.FieldValue.serverTimestamp()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return docRef.id;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('Error saving contact:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>throw error;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async getContacts() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const userId = firebase.auth().currentUser.uid;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const snapshot = await firebase.firestore()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.collection('contacts')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.where('userId', '==', userId)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.orderBy('createdAt', 'desc')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.get();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return snapshot.docs.map(doc =&gt; ({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>id: doc.id,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>...doc.data()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('Error getting contacts:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>throw error;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async uploadBusinessCardImage(imageBlob, contactId) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const storageRef = firebase.storage().ref();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const imageRef = storageRef.child(`business-cards/${contactId}.jpg`);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const snapshot = await imageRef.put(imageBlob);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const downloadURL = await snapshot.ref.getDownloadURL();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Aggiorna il contatto con l'URL dell'immagine<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>await firebase.firestore()<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.collection('contacts')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.doc(contactId)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>.update({ businessCardUrl:
downloadURL });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return downloadURL;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('Error uploading image:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>throw error;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async syncOfflineChanges() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Recupera modifiche offline dal localStorage<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const offlineChanges = JSON.parse(localStorage.getItem('offlineChanges')
|| '[]');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (const change of offlineChanges) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>switch(change.type) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>case 'create':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>await
this.saveContact(change.data);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>break;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>case 'update':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>await
this.updateContact(change.id, change.data);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>break;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>case 'delete':<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>await
this.deleteContact(change.id);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>break;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>console.error('Sync error:',
error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Pulisci le modifiche offline<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>localStorage.removeItem('offlineChanges');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 4. EXPORT DATI (CSV, Excel, PDF)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class DataExporter {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.contacts = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>exportToCSV(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const headers = ['Nome', 'Azienda', 'Ruolo', 'Telefono', 'Email',
'Indirizzo', 'Settore', 'Note', 'Data Creazione'];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const csvContent = [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headers.join(','),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>...contacts.map(contact =&gt; [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.name),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.escapeCSV(contact.company),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.role),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.phone),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.email),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.escapeCSV(contact.address),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.sector),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>this.escapeCSV(contact.notes),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>new
Date(contact.createdAt).toLocaleDateString('it-IT')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>].join(','))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>].join('\n');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.downloadFile(csvContent, 'contacts.csv', 'text/csv');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>escapeCSV(str) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!str) return '';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (str.includes(',') || str.includes('&quot;') || str.includes('\n')) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return `&quot;${str.replace(/&quot;/g, '&quot;&quot;')}&quot;`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return str;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async exportToExcel(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Usa SheetJS (xlsx library)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const worksheet = XLSX.utils.json_to_sheet(contacts.map(contact =&gt; ({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Nome': contact.name,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Azienda': contact.company,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Ruolo': contact.role,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Telefono': contact.phone,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Email': contact.email,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Indirizzo': contact.address,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Settore': contact.sector,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Note': contact.notes,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Preferito': contact.starred ? 'S' : 'No',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Data Creazione': new
Date(contact.createdAt).toLocaleDateString('it-IT')<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>})));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const workbook = XLSX.utils.book_new();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>XLSX.utils.book_append_sheet(workbook, worksheet, 'Contatti');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Styling<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const range = XLSX.utils.decode_range(worksheet['!ref']);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let C = range.s.c; C &lt;= range.e.c; ++C) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const address = XLSX.utils.encode_col(C) + &quot;1&quot;;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!worksheet[address]) continue;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>worksheet[address].s = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>font: { bold: true },<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>fill: { fgColor: { rgb:
&quot;667EEA&quot; } }<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>XLSX.writeFile(workbook, 'contacts.xlsx');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async exportToPDF(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Usa jsPDF<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const { jsPDF } = window.jspdf;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const doc = new jsPDF();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Header<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.setFontSize(20);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.text('Lista Contatti Business', 14, 22);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.setFontSize(10);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.text(`Generato il: ${new Date().toLocaleDateString('it-IT')}`, 14,
30);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.text(`Totale contatti: ${contacts.length}`, 14, 36);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Tabella contatti<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const tableColumns = ['Nome', 'Azienda', 'Telefono', 'Email'];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const tableRows = contacts.map(contact =&gt; [<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contact.name,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contact.company || 'N/A',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contact.phone || 'N/A',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contact.email || 'N/A'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>]);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.autoTable({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>head: [tableColumns],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>body: tableRows,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>startY: 45,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>styles: { fontSize: 8 },<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headStyles: { fillColor: [102, 126, 234] }<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>doc.save('contacts.pdf');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>exportToVCard(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const vcard = `BEGIN:VCARD<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>VERSION:3.0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>FN:${contact.name}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>ORG:${contact.company || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>TITLE:${contact.role || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>TEL:${contact.phone || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>EMAIL:${contact.email || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>ADR:;;${contact.address || ''};;;;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>NOTE:${contact.notes || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>END:VCARD`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.downloadFile(vcard, `${contact.name.replace(/\s+/g, '_')}.vcf`,
'text/vcard');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>downloadFile(content, filename, mimeType) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const blob = new Blob([content], { type: mimeType });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const url = URL.createObjectURL(blob);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const a = document.createElement('a');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.href = url;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.download = filename;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>document.body.appendChild(a);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.click();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>document.body.removeChild(a);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(url);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 5. GEOLOCALIZZAZIONE E MAPPA CONTATTI<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class ContactsMap {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor(mapContainerId) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.mapContainerId = mapContainerId;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.map = null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.markers = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async initializeMap() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Usa Leaflet per mappe open source<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;link rel=&quot;stylesheet&quot;
href=&quot;https://unpkg.com/leaflet/dist/leaflet.css&quot; /&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://unpkg.com/leaflet/dist/leaflet.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.map = L.map(this.mapContainerId).setView([41.9028, 12.4964], 6); //
Italia<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>attribution: ' OpenStreetMap contributors'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}).addTo(this.map);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async geocodeAddress(address) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Usa Nominatim per geocoding gratuito<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const url =
`https://nominatim.openstreetmap.org/search?format=json&amp;q=${encodeURIComponent(address)}`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await fetch(url);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const data = await response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (data &amp;&amp; data[0]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>lat:
parseFloat(data[0].lat),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>lng:
parseFloat(data[0].lon),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>display_name:
data[0].display_name<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>console.error('Geocoding error:', error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async addContactToMap(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!contact.address) return;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const location = await this.geocodeAddress(contact.address);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!location) return;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const marker = L.marker([location.lat, location.lng])<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.addTo(this.map)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.bindPopup(`<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>&lt;strong&gt;${contact.name}&lt;/strong&gt;&lt;br&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>${contact.company ||
''}&lt;br&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>${contact.address}&lt;br&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>&lt;a
href=&quot;tel:${contact.phone}&quot;&gt;${contact.phone}&lt;/a&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>`);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.markers.push(marker);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async plotAllContacts(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Rimuovi marker esistenti<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.markers.forEach(marker =&gt; marker.remove());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.markers = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Aggiungi nuovi marker<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (const contact of contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>await this.addContactToMap(contact);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Adatta la vista per mostrare tutti i marker<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (this.markers.length &gt; 0) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const group = L.featureGroup(this.markers);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.map.fitBounds(group.getBounds().pad(0.1));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>calculateDistance(lat1, lon1, lat2, lon2) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Formula Haversine per calcolare distanza tra due punti<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const R = 6371; // Raggio della Terra in km<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const dLat = (lat2 - lat1) * Math.PI / 180;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const dLon = (lon2 - lon1) * Math.PI / 180;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const a = Math.sin(dLat/2) * Math.sin(dLat/2) +<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>Math.cos(lat1 * Math.PI /
180) * Math.cos(lat2 * Math.PI / 180) *<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>Math.sin(dLon/2) *
Math.sin(dLon/2);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return R * c;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async findNearbyContacts(userLat, userLon, radiusKm, contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const nearbyContacts = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (const contact of contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!contact.address) continue;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const location = await this.geocodeAddress(contact.address);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!location) continue;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const distance = this.calculateDistance(userLat, userLon, location.lat,
location.lng);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (distance &lt;= radiusKm) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>nearbyContacts.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>...contact,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>distance:
Math.round(distance * 10) / 10<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return nearbyContacts.sort((a, b) =&gt; a.distance - b.distance);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 6. NOTIFICHE PUSH E PROMEMORIA<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class NotificationManager {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.permission = null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async requestPermission() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if ('Notification' in window) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.permission = await Notification.requestPermission();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return this.permission === 'granted';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return false;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>showNotification(title, options = {}) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (this.permission !== 'granted') return;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const notification = new Notification(title, {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>icon: '/icon-192x192.png',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>badge: '/badge-72x72.png',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>vibrate: [200, 100, 200],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>...options<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>notification.onclick = function(event) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>event.preventDefault();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>window.focus();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>notification.close();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return notification;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>scheduleFollowUpReminder(contact, date) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const now = new Date();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const reminderDate = new Date(date);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const timeUntilReminder = reminderDate - now;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (timeUntilReminder &gt; 0) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>setTimeout(() =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.showNotification('Promemoria Follow-up', {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>body: ` ora di
ricontattare ${contact.name} - ${contact.company}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>tag:
`followup-${contact.id}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>data: { contactId:
contact.id }<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}, timeUntilReminder);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>setupBackgroundSync() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if ('serviceWorker' in navigator &amp;&amp; 'SyncManager' in window) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>navigator.serviceWorker.ready.then(registration =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return
registration.sync.register('sync-contacts');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 7. ANALYTICS AVANZATE<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class AdvancedAnalytics {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.contacts = contacts;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getContactsGrowth() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const monthlyGrowth = {};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.contacts.forEach(contact =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const date = new Date(contact.createdAt);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const monthKey = `${date.getFullYear()}-${String(date.getMonth() +
1).padStart(2, '0')}`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>monthlyGrowth[monthKey] = (monthlyGrowth[monthKey] || 0) + 1;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return Object.entries(monthlyGrowth)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.sort((a, b) =&gt; a[0].localeCompare(b[0]))<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.map(([month, count]) =&gt; ({ month, count }));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getTopCompanies() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const companyCount = {};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.contacts.forEach(contact =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.company) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>companyCount[contact.company] =
(companyCount[contact.company] || 0) + 1;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return Object.entries(companyCount)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.sort((a, b) =&gt; b[1] - a[1])<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.slice(0, 10)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>.map(([company, count]) =&gt; ({ company, count }));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getConversionFunnel() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const funnel = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>scanned: this.contacts.length,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contacted: this.contacts.filter(c =&gt; c.lastContactedAt).length,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>qualified: this.contacts.filter(c =&gt; c.qualified).length,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>converted: this.contacts.filter(c =&gt; c.converted).length<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return funnel;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getEngagementScore(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>let score = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Fattori di engagement<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.email) score += 20;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.phone) score += 20;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.company) score += 15;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.role) score += 15;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.linkedin) score += 10;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.notes) score += 10;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.starred) score += 10;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Interazioni<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const daysSinceCreation = (Date.now() - new Date(contact.createdAt)) /
(1000 * 60 * 60 * 24);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (daysSinceCreation &lt; 7) score += 20;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>else if (daysSinceCreation &lt; 30) score += 10;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return Math.min(score, 100);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getNetworkValue() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const sectorValues = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Tecnologia': 1000,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Finanza': 1500,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Manifatturiero': 800,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Servizi': 600,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Consulenza': 1200,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>'Commercio': 500<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>let totalValue = 0;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.contacts.forEach(contact =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const baseValue = sectorValues[contact.sector] || 400;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const engagementMultiplier = this.getEngagementScore(contact) / 100;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>totalValue += baseValue * engagementMultiplier;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return Math.round(totalValue);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 8. INTEGRAZIONE CALENDARIO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class CalendarIntegration {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>createGoogleCalendarEvent(contact, date, duration = 60) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const startDate = new Date(date);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const endDate = new Date(startDate.getTime() + duration * 60000);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const event = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>text: `Meeting con ${contact.name}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>dates:
`${this.formatDateForGoogle(startDate)}/${this.formatDateForGoogle(endDate)}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>details: `Incontro con ${contact.name} di ${contact.company}. Tel:
${contact.phone}, Email: ${contact.email}`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>location: contact.address || ''<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const googleCalendarUrl =
`https://calendar.google.com/calendar/render?action=TEMPLATE&amp;text=${encodeURIComponent(event.text)}&amp;dates=${event.dates}&amp;details=${encodeURIComponent(event.details)}&amp;location=${encodeURIComponent(event.location)}`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>window.open(googleCalendarUrl, '_blank');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>formatDateForGoogle(date) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return date.toISOString().replace(/-|:|\.\d\d\d/g, '');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>createICSFile(contact, date, duration = 60) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const startDate = new Date(date);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const endDate = new Date(startDate.getTime() + duration * 60000);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const icsContent = `BEGIN:VCALENDAR<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>VERSION:2.0<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>PRODID:-//Business Card Scanner//EN<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>BEGIN:VEVENT<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>UID:${Date.now()}@businesscardscanner.com<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>DTSTAMP:${this.formatDateForICS(new
Date())}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>DTSTART:${this.formatDateForICS(startDate)}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>DTEND:${this.formatDateForICS(endDate)}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>SUMMARY:Meeting con ${contact.name}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>DESCRIPTION:Incontro con ${contact.name}
di ${contact.company}\\nTel: ${contact.phone}\\nEmail: ${contact.email}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>LOCATION:${contact.address || ''}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>END:VEVENT<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>END:VCALENDAR`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const blob = new Blob([icsContent], { type: 'text/calendar' });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const url = URL.createObjectURL(blob);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const a = document.createElement('a');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.href = url;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.download = `meeting_${contact.name.replace(/\s+/g, '_')}.ics`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.click();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(url);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>formatDateForICS(date) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return date.toISOString().replace(/-|:|\.\d\d\d/g,
'').replace(/\.\d\d\dZ/, 'Z');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 9. INTELLIGENZA ARTIFICIALE E
SUGGERIMENTI<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class AIAssistant {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.patterns = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>emailDomain: {},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>companySector: {},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>roleKeywords: {}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>learnFromContacts(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contacts.forEach(contact =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Impara pattern email-azienda<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.email &amp;&amp; contact.company) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>const domain =
contact.email.split('@')[1];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.patterns.emailDomain[domain] = contact.company;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Impara associazioni azienda-settore<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.company &amp;&amp; contact.sector) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.patterns.companySector[contact.company] = contact.sector;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Impara keyword ruoli<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.role) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>const keywords =
contact.role.toLowerCase().split(' ');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>keywords.forEach(keyword =&gt;
{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>if
(!this.patterns.roleKeywords[keyword]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.patterns.roleKeywords[keyword] = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.patterns.roleKeywords[keyword].push(contact.sector);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestCompanyFromEmail(email) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!email) return null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const domain = email.split('@')[1];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return this.patterns.emailDomain[domain] || null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestSectorFromCompany(company) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!company) return null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Cerca corrispondenza esatta<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (this.patterns.companySector[company]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return this.patterns.companySector[company];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Cerca corrispondenza parziale<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (const [knownCompany, sector] of
Object.entries(this.patterns.companySector)) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (company.toLowerCase().includes(knownCompany.toLowerCase()) ||<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>knownCompany.toLowerCase().includes(company.toLowerCase())) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>return sector;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestSectorFromRole(role) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!role) return null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const keywords = role.toLowerCase().split(' ');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const sectorCounts = {};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>keywords.forEach(keyword =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (this.patterns.roleKeywords[keyword]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.patterns.roleKeywords[keyword].forEach(sector =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>sectorCounts[sector] =
(sectorCounts[sector] || 0) + 1;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Ritorna il settore pi frequente<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const sortedSectors = Object.entries(sectorCounts).sort((a, b) =&gt;
b[1] - a[1]);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return sortedSectors.length &gt; 0 ? sortedSectors[0][0] : null;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>generateFollowUpSuggestions(contact) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const suggestions = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const daysSinceCreation = (Date.now() - new Date(contact.createdAt)) /
(1000 * 60 * 60 * 24);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (daysSinceCreation &gt; 7 &amp;&amp; !contact.lastContactedAt) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestions.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'follow-up',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>priority: 'high',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>message: ` passata una
settimana dal primo contatto con ${contact.name}. Considera di inviare un'email
di follow-up.`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>action: 'send-email'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!contact.linkedin &amp;&amp; contact.role) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestions.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'enrich',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>priority: 'medium',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>message: `Cerca ${contact.name}
su LinkedIn per completare il profilo.`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>action: 'search-linkedin'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (contact.company &amp;&amp; !contact.website) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>suggestions.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'research',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>priority: 'low',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>message: `Ricerca il sito web
di ${contact.company} per maggiori informazioni.`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>action: 'search-web'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return suggestions;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>detectDuplicates(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const duplicates = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const seen = {};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contacts.forEach((contact, index) =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Crea chiavi uniche per rilevare duplicati<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const emailKey = contact.email?.toLowerCase();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const phoneKey = contact.phone?.replace(/\D/g, '');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const nameKey = contact.name?.toLowerCase().replace(/\s+/g, '');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Controlla email duplicata<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (emailKey &amp;&amp; seen[`email:${emailKey}`]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>duplicates.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'email',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>contacts:
[seen[`email:${emailKey}`], contact]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} else if (emailKey) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>seen[`email:${emailKey}`] =
contact;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Controlla telefono duplicato<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (phoneKey &amp;&amp; seen[`phone:${phoneKey}`]) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>duplicates.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'phone',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>contacts:
[seen[`phone:${phoneKey}`], contact]<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} else if (phoneKey) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>seen[`phone:${phoneKey}`] =
contact;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Controlla nome simile (fuzzy matching)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (nameKey) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>for (const key in seen) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>if
(key.startsWith('name:')) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>const existingName =
key.substring(5);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>if
(this.calculateSimilarity(nameKey, existingName) &gt; 0.8) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>duplicates.push({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>type: 'name',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>contacts:
[seen[key], contact],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>similarity:
this.calculateSimilarity(nameKey, existingName)<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>seen[`name:${nameKey}`] =
contact;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return duplicates;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>calculateSimilarity(str1, str2) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Algoritmo di Levenshtein semplificato<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const longer = str1.length &gt; str2.length ? str1 : str2;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const shorter = str1.length &gt; str2.length ? str2 : str1;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (longer.length === 0) return 1.0;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const editDistance = this.levenshteinDistance(longer, shorter);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return (longer.length - editDistance) / longer.length;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>levenshteinDistance(str1, str2) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const matrix = [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let i = 0; i &lt;= str2.length; i++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>matrix[i] = [i];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let j = 0; j &lt;= str1.length; j++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>matrix[0][j] = j;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let i = 1; i &lt;= str2.length; i++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>for (let j = 1; j &lt;= str1.length; j++) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>if (str2.charAt(i - 1) ===
str1.charAt(j - 1)) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>matrix[i][j] = matrix[i -
1][j - 1];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>} else {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>matrix[i][j] = Math.min(<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>matrix[i - 1][j - 1] +
1,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>matrix[i][j - 1] + 1,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>matrix[i - 1][j] + 1<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return matrix[str2.length][str1.length];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// 10. BACKUP E RESTORE<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>class BackupManager {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>constructor() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>this.backupKey = 'businesscard_backups';<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>createBackup(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>timestamp: new Date().toISOString(),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>version: '1.0.0',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>contacts: contacts,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>settings: this.getAppSettings(),<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>metadata: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>totalContacts: contacts.length,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>device: navigator.userAgent,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>appVersion: '1.0.0'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return backup;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>saveLocalBackup(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = this.createBackup(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backups = this.getLocalBackups();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Mantieni solo gli ultimi 5 backup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>backups.unshift(backup);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (backups.length &gt; 5) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>backups.pop();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>localStorage.setItem(this.backupKey, JSON.stringify(backups));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return backup;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getLocalBackups() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backups = localStorage.getItem(this.backupKey);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return backups ? JSON.parse(backups) : [];<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async saveToGoogleDrive(contacts) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Richiede Google Drive API<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://apis.google.com/js/api.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = this.createBackup(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const file = new Blob([JSON.stringify(backup, null, 2)], { type:
'application/json' });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Inizializza Google Drive API<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>await this.initGoogleDrive();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const metadata = {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>name: `backup_businesscards_${new Date().toISOString()}.json`,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>mimeType: 'application/json',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>parents: ['appDataFolder']<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const form = new FormData();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>form.append('metadata', new Blob([JSON.stringify(metadata)], { type:
'application/json' }));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>form.append('file', file);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const response = await
fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart',
{<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>method: 'POST',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>headers: {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>'Authorization': `Bearer
${gapi.auth.getToken().access_token}`<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>},<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>body: form<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return response.json();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async restoreFromBackup(backup) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Valida il backup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (!backup.contacts || !Array.isArray(backup.contacts)) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>throw new Error('Backup non
valido');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Ripristina contatti<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>localStorage.setItem('businessCards', JSON.stringify(backup.contacts));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Ripristina impostazioni<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>if (backup.settings) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'>
</span>this.restoreAppSettings(backup.settings);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>success: true,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>contactsRestored:
backup.contacts.length,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>timestamp: backup.timestamp<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>success: false,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>error: error.message<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>exportEncryptedBackup(contacts, password) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Usa CryptoJS per crittografia<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Include: &lt;script
src=&quot;https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js&quot;&gt;&lt;/script&gt;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = this.createBackup(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const encrypted = CryptoJS.AES.encrypt(JSON.stringify(backup),
password).toString();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const blob = new Blob([encrypted], { type: 'text/plain' });<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const url = URL.createObjectURL(blob);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const a = document.createElement('a');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.href = url;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.download = `backup_encrypted_${new Date().toISOString()}.bcs`;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>a.click();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>URL.revokeObjectURL(url);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>importEncryptedBackup(encryptedData, password) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const decrypted = CryptoJS.AES.decrypt(encryptedData, password);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = JSON.parse(decrypted.toString(CryptoJS.enc.Utf8));<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return this.restoreFromBackup(backup);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>success: false,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>error: 'Password errata o file
corrotto'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>getAppSettings() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>theme: localStorage.getItem('theme') || 'light',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>language: localStorage.getItem('language') || 'it',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>syncEnabled: localStorage.getItem('syncEnabled') === 'true',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>notificationsEnabled: localStorage.getItem('notificationsEnabled') ===
'true',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>autoBackup: localStorage.getItem('autoBackup') === 'true'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>};<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>restoreAppSettings(settings) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>Object.entries(settings).forEach(([key, value]) =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>localStorage.setItem(key, value.toString());<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>async initGoogleDrive() {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>return new Promise((resolve, reject) =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>gapi.load('client:auth2', async () =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>try {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>await gapi.client.init({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>apiKey: 'YOUR_API_KEY',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>clientId:
'YOUR_CLIENT_ID',<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>discoveryDocs:
['https://www.googleapis.com/discovery/v1/apis/drive/v3/rest'],<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>scope:
'https://www.googleapis.com/auth/drive.appdata'<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>resolve();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>} catch (error) {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>reject(error);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span
style='mso-spacerun:yes'> </span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>}<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// ESEMPIO DI UTILIZZO COMPLETO<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>//
============================================<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// Inizializzazione<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>document.addEventListener('DOMContentLoaded',
async () =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 1. Inizializza OCR<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const ocr = new GoogleVisionOCR('YOUR_GOOGLE_VISION_API_KEY');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 2. Inizializza CRM<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const crm = new CRMIntegration('hubspot', 'YOUR_HUBSPOT_API_KEY');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 3. Inizializza Cloud Sync<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const cloudSync = new CloudSync({<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>apiKey: &quot;your-firebase-api-key&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>authDomain: &quot;your-app.firebaseapp.com&quot;,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>projectId: &quot;your-project-id&quot;<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 4. Inizializza Export<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const exporter = new DataExporter();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 5. Inizializza Mappa<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const contactsMap = new ContactsMap('mapContainer');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>await contactsMap.initializeMap();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 6. Inizializza Notifiche<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const notifications = new NotificationManager();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>await notifications.requestPermission();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 7. Inizializza Analytics<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const contacts = JSON.parse(localStorage.getItem('businessCards') ||
'[]');<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const analytics = new AdvancedAnalytics(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 8. Inizializza AI Assistant<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const ai = new AIAssistant();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>ai.learnFromContacts(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// 9. Inizializza Backup<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>const backup = new BackupManager();<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'> </span><o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>// Auto-backup ogni 24 ore<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>setInterval(() =&gt; {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>backup.saveLocalBackup(contacts);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>}, 24 * 60 * 60 * 1000);<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>});<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><o:p>&nbsp;</o:p></span></p>

<p class=MsoNormal><span lang=es-419>// Export per uso in altri moduli<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>export {<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>GoogleVisionOCR,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>CRMIntegration,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>CloudSync,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>DataExporter,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>ContactsMap,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>NotificationManager,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>AdvancedAnalytics,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>CalendarIntegration,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>AIAssistant,<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419><span style='mso-spacerun:yes'>
</span>BackupManager<o:p></o:p></span></p>

<p class=MsoNormal><span lang=es-419>};</span></p>

</div>

</body>

</html>
